# Blockscope Configuration Example
# Copy this file to config.yaml and fill in your values
# Environment variables can override any value using FS_ prefix
# Example: FS_RPC_URL overrides rpc.url

rpc:
  url: "http://127.0.0.1:8332"
  user: "bitcoin"  # Set your RPC username here or via FS_RPC_USER env var
  password: ""   # Set your RPC password here or via FS_RPC_PASS env var

polling:
  poll_secs: 60
  rolling_window_mins: 60

alerts:
  webhook_url: ""  # Optional webhook URL for alerts
  min_change_secs: 300

spike_detection:
  enabled: true
  spike_pct: 35  # % increase over trailing average to trigger alert
  min_alert_satvb: 15  # Minimum absolute fee to care about spikes
  cooldown_minutes: 20  # Debounce for spike alerts
  adjustment_rules:
    target_sat_vb_floor: 12
    bump_pct_if_queue_backlog: 20
    drop_pct_if_clearing_fast: 15

consolidation:
  label: "feesentinel"
  min_utxo_sats: 546
  max_inputs: 50
  target_address: ""  # Set target address for UTXO consolidation
  min_trigger_satvb: 5
  psbt_cooldown_secs: 3600  # Minimum seconds between PSBT preparations (1 hour default)

logging:
  level: "INFO"  # DEBUG, INFO, WARNING, ERROR
  logfile: ""  # Leave empty for stdout/stderr
  log_dir: "logs"  # Base directory for logs
  console_level: "INFO"  # Separate console log level
  rotation:
    max_bytes: 10485760  # 10MB
    backup_count: 30  # Keep 30 rotated files
    when: "midnight"  # Daily rotation at midnight

structured_output:
  enabled: false  # When true, write JSONL records for future database rollups
  base_dir: "logs/structured"  # Directory for JSONL files
  events_filename: "events.jsonl"  # All blockchain events (treasury, ordinals, covenants, blocks)
  blocks_filename: "blocks.jsonl"  # Per-block summaries and metrics
  fee_alerts_filename: "fee_alerts.jsonl"  # Fee bucket change + PSBT alerts
  fee_snapshots_filename: "fee_snapshots.jsonl"  # Periodic fee snapshots

event_watcher:
  enabled: true  # Set to true to enable event watching
  poll_interval_secs: 10  # Seconds between block checks
  start_height: null  # null = start from current height
  max_reorg_depth: 6  # Maximum reorg depth to handle
  
  filters:
    treasury:
      enabled: true  # Watch for UTXO activity on treasury addresses
      # Let the internal registry own the core big addresses (USG, hacks, monuments)
      # Use this ONLY for additional custom ones you care about.
      # These are merged into the structured registry below.
      addresses: []

      # Structured famous addresses with metadata (internal registry)
      famous_addresses:
        # Protocol / history "monuments"
        - id: "genesis_satoshi"
          label: "Genesis / Satoshi"
          category: "protocol_monument"
          addresses:
            - "1A1zP1eP5QGefi2DMPTfTL5SLmv7DivfNa"
          notes: "First 50 BTC coinbase from the genesis block; never spent, still accumulates dust and donations."
          tags: ["genesis", "satoshi", "monument"]
        
        - id: "counterparty_burn"
          label: "Counterparty Proof-of-Burn"
          category: "burn"
          addresses:
            - "1CounterpartyXXXXXXXXXXXXXXXUWLpVr"
          notes: "Used in 2014 to burn BTC in exchange for XCP; standard example of proof-of-burn."
          tags: ["burn", "counterparty", "xcp"]
        
        - id: "bitcoin_eater"
          label: "Bitcoin Eater Address"
          category: "burn"
          addresses:
            - "1BitcoinEaterAddressDontSendf59kuE"
          notes: "Classic 'eater' address; coins sent here are effectively gone."
          tags: ["burn", "eater"]
        
        - id: "bogus_burn"
          label: "Extreme Bogus/Burn Address"
          category: "burn"
          addresses:
            - "1111111111111111111114oLvT2"
          notes: "Smallest possible hash160, used as a canonical 'bogus' / burn address in research."
          tags: ["burn", "bogus", "research"]
        
        # Hacks and exchange disasters
        - id: "mtgox_hack"
          label: "Mt. Gox Hack Stash"
          category: "hack"
          addresses:
            - "1FeexV6bAHb8ybZjqQMjJrcCrHGW9sb6uF"
          notes: "Widely analyzed as holding ~75k BTC linked to the Gox theft and never moved."
          tags: ["hack", "mtgox", "theft"]
        
        - id: "bitfinex_2016_hack"
          label: "Bitfinex 2016 Hack Consolidation"
          category: "hack"
          addresses:
            - "bc1qazcm763858nkj2dj986etajv6wquslv8uxwczt"
          notes: "Research shows ~94.6k BTC (â‰ˆ79% of the 119,756 BTC stolen) consolidated here; tied to the 2016 Bitfinex hack and later US enforcement actions."
          tags: ["hack", "bitfinex", "2016"]
        
        # US Government & seizure treasuries
        - id: "silk_road_individual_x"
          label: "Silk Road 'Individual X' Seizure (USG)"
          category: "USG_seizure"
          addresses:
            - "bc1qa5wkgaew2dkv56kfvj49j0av5nml45x9ek9hz6"
          notes: "Holds coins seized from an unidentified Silk Road hacker ('Individual X'), one of the largest BTC seizures."
          tags: ["USG", "seizure", "silk_road"]
        
        - id: "james_zhong_seizure"
          label: "James Zhong Silk Road Hack Seizure (USG)"
          category: "USG_seizure"
          addresses:
            - "bc1qmxjefnuy06v345v6vhwpwt05dztztmx4g3y7wp"
          notes: "Consolidation wallet for ~49,825 BTC seized from James Zhong (50,676 BTC total), later partially auctioned by US Marshals."
          tags: ["USG", "seizure", "silk_road", "james_zhong"]
      
      # Entity-level clusters (e.g., USG, exchanges, corporate treasuries)
      clusters:
        - id: "usg_treasury"
          label: "US Government Bitcoin Holdings"
          category: "USG_seizure"
          addresses:
            - "bc1qa5wkgaew2dkv56kfvj49j0av5nml45x9ek9hz6"
            - "bc1qmxjefnuy06v345v6vhwpwt05dztztmx4g3y7wp"
          notes: "Aggregated view of US Government Bitcoin seizure addresses. Movements usually correspond to auctions, OTC deals, or internal reshuffles."
          tags: ["USG", "seizure", "treasury"]
        
        - id: "major_hacks"
          label: "Major Exchange Hacks"
          category: "hack"
          addresses:
            - "1FeexV6bAHb8ybZjqQMjJrcCrHGW9sb6uF"
            - "bc1qazcm763858nkj2dj986etajv6wquslv8uxwczt"
          notes: "Addresses associated with major exchange hacks (Mt. Gox, Bitfinex)."
          tags: ["hack", "exchange"]
      
      # External YAML files for private/extended mappings
      # Note: Addresses are widely referenced but should be manually confirmed against
      # technical or legal primary sources (DOJ filings, protocol docs, chain-analytics writeups).
      # Treat these as starting points, not a canonical list.
      # External YAML files for extended/public mappings (see examples/treasuries.example.yaml)
      address_files: []  # List of file paths (e.g., ["config/treasuries_public.yaml"])
      watch_inputs: true  # Watch for spends from treasury addresses
      watch_outputs: true  # Watch for receives to treasury addresses
    
    ordinals:
      enabled: true  # Detect ordinal inscriptions
      detect_inscriptions: true  # Keep enabled; relies on heuristics
      # Ordinals hotspots (brokers, experiments, important inscription addresses)
      hotspots: []  # List of {id, label, addresses: [...]}
    
    covenants:
      # Start disabled by default; re-enable when you have specific covenant patterns to watch
      enabled: false
      patterns: []  # Covenant patterns to detect
 
  events:
    webhook_url: ""  # Primary webhook endpoint for events
    webhook_urls: []  # Additional webhook endpoints
    retry_attempts: 3  # Number of retry attempts per event
    retry_backoff_secs: 5  # Base backoff time in seconds (exponential)
  
  state:
    backend: "sqlite"  # "sqlite" or "json"
    db_path: "state/eventwatcher.db"  # SQLite database path
    json_path: "state/eventwatcher.json"  # JSON state file path
  
  metrics:
    enabled: true  # Enable metrics logging
    log_interval_secs: 300  # Log metrics every N seconds

